/** Class for building a carusel on the webpage */
class Carusel {
    constructor() {
    }
    /**Starts the carusel build and loads the BigProjects-Index.json file */
    carusel() {
        let xhttp = new XMLHttpRequest();
        xhttp.open("GET", "Resources/Texts/BigProjects-Index.json", true);
        xhttp.responseType = 'json';
        xhttp.send();
        xhttp.onreadystatechange = () => {
            if (xhttp.readyState == 4 && xhttp.status == 200) {
                this.buildList(xhttp.response.length);
                xhttp.response.forEach((item, pos) => {
                    this.readListItem(item, pos);
                });
            }
            else if (xhttp.status != 200) {
                console.log(xhttp.readyState);
            }
        };
    }
    /**reads each item of BigProjects-Index.json and loads the indexed files */
    readListItem(item, pos) {
        let request = new XMLHttpRequest();
        let changed = true;
        request.open("GET", " Resources/Texts/" + item.title + ".json", true);
        request.responseType = 'json';
        request.send();
        request.onreadystatechange = () => {
            if (request.readyState == 4 && request.status == 200) {
                this.buildCarousel(request.response, pos);
            }
        };
    }
    /**builds the overview of the carusel*/
    buildList(number) {
        let text;
        let active;
        text = "";
        for (let i = 0; i < number; i++) {
            if (i === 0) {
                active = ' class="active"';
            }
            else {
                active = ' class';
            }
            text += "<li data-target=\"#myCarousel\" data-slide-to=" + i + active + "></li>";
        }
        let element = document.getElementsByClassName("carousel-indicators").item(0);
        element.insertAdjacentHTML('afterbegin', text);
    }
    /**takes each project file indext by BigProjects-Index.json and turns them into a card for the carusel slide */
    buildCarousel(carouselItems, pos) {
        let str;
        if (pos === 0) {
            str = '<div class="carousel-item active">' + "\n";
        }
        else {
            str = '<div class="carousel-item">' + "\n";
        }
        if (carouselItems.color == null) {
            carouselItems.color = "#777";
        }
        if (carouselItems.picture == null) {
            str += '<svg class="bd-placeholder-img" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice\" focusable=\"false\" role=\"img\"><rect width=\"100%\" height=\"100%\" fill="' + carouselItems.color + '"/></svg>' + "\n";
        }
        else {
            str += '<img class="bd-img" width="100%" height="100%" src="' + carouselItems.picture + '"/>';
        }
        str += '<div class="container">' + "\n";
        str += '<div class="carousel-caption text-left">' + "\n";
        str += "<h1>" + carouselItems.title + "</h1>" + "\n";
        str += "<p>" + carouselItems.info + "</p>" + "\n";
        if (carouselItems.button == true) {
            str += '<p><a class="btn btn-lg btn-primary" href="' + carouselItems.link + '" role="button">' + carouselItems.button_picture + " " + carouselItems.buttonLinksTo + '</a></p>' + "\n";
        }
        str += "</div>" + "\n";
        str += "</div>" + "\n";
        str += "</div>" + "\n";
        this.addCaruselToHTML(str);
    }
    /**Adds the html of the carusel to the rest of the site */
    addCaruselToHTML(html) {
        let element = document.getElementById("carousel-frame");
        //console.log(html);
        element.insertAdjacentHTML("beforeend", html);
    }
}
/**Class for building a list of smaller projects on the webpage*/
class SmallProjects {
    constructor() {
    }
    smallProjects() {
        let spRequest = new XMLHttpRequest();
        spRequest.open("GET", "Resources/Texts/SmallProjects-Index.json", true);
        spRequest.responseType = 'json';
        spRequest.send();
        spRequest.onreadystatechange = () => {
            if (spRequest.readyState == 4 && spRequest.status == 200) {
                //console.log(spRequest.response);
                spRequest.response.forEach((item) => {
                    //console.log(spRequest)
                    this.readSmallProjectIndex(item);
                });
            }
        };
    }
    readSmallProjectIndex(item) {
        let request = new XMLHttpRequest();
        let changed = true;
        request.open("GET", "Resources/Texts/" + item.title + ".json", true);
        request.responseType = 'json';
        request.send();
        request.onreadystatechange = () => {
            if (request.readyState == 4 && request.status == 200) {
                this.buildSmallProjects(request.response);
            }
        };
    }
    buildSmallProjects(smallProject) {
        let str;
        str = '<div class="col-lg-4">' + "\n";
        if (smallProject.color == null) {
            smallProject.color = "#777";
        }
        if (smallProject.picture == null) {
            str += '<svg class="bd-placeholder-img rounded-circle" width="140" height="140" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: 140x140">' + "\n";
            str += '<title>Placeholder</title>' + "\n";
            str += '<rect width="100%" height="100%" fill="' + smallProject.color + '"/>' + "\n";
            str += '<text class="placeholder" font-size="45" text-anchor="middle" alignment-baseline="central" fill="#fff"> <tspan x="50%" dy="60%">' + smallProject.short + '</tspan></text></svg>';
        }
        else {
            str += '<img class="bd-img rounded-circle" width="140" height="140" src=' + smallProject.picture + '" alt="' + smallProject.short + '"/>';
        }
        str += "<h2>" + smallProject.title + "</h2>" + "\n";
        str += "<p>" + smallProject.info + "</p>" + "\n";
        if (smallProject.button == true && smallProject.button_picture != null) {
            str += '<p><a class="btn btn-secondary" href=' + smallProject.link + ' role="button">' + smallProject.button_picture + " " + smallProject.buttonLinksTo + '</a></p>' + "\n";
        }
        else if (smallProject.button == true) {
            str += '<p><a class="btn btn-secondary" href=' + smallProject.link + ' role="button">' + smallProject.buttonLinksTo + '</a></p>' + "\n";
        }
        str += "</div>" + "\n";
        this.addSmallProjectToHTML(str);
    }
    addSmallProjectToHTML(html) {
        let element = document.getElementById("sp");
        //console.log(html);
        element.insertAdjacentHTML("beforeend", html);
    }
}
/* IDEA change script to load/unload content under the header so i can use a single url?
 *
 */
/*MAIN*/
let carusel = new Carusel;
let smallProjects = new SmallProjects;
document.addEventListener("touchstart", function () {
}, true);
document.addEventListener("DOMContentLoaded", () => {
    start(true);
});
function start(firstRun) {
    if (firstRun) {
        document.getElementById("Projects").addEventListener("click", changeActivNavItem);
        document.getElementById("Skills").addEventListener("click", changeActivNavItem);
        document.getElementById("Contact").addEventListener("click", changeActivNavItem);
    }
    let activNavItem = document.getElementsByClassName("nav-item active")[0].children[0].textContent;
    if (activNavItem == "Projects") {
        loadSubSite(activNavItem);
        carusel.carusel();
        smallProjects.smallProjects();
    }
    else if (activNavItem == "Skills") {
        loadSubSite(activNavItem);
    }
    else if (activNavItem == "Contact") {
        loadSubSite(activNavItem);
    }
}
/** Changes the active NavItem to the clicked one*/
function changeActivNavItem(e) {
    //@ts-ignore
    let navItem = e.currentTarget;
    let activNavItem = document.getElementsByClassName("nav-item active");
    if (activNavItem.length <= 1) {
        activNavItem[0].children[0].setAttribute("class", "nav-link");
        activNavItem[0].setAttribute("class", "nav-item");
    }
    navItem.setAttribute("class", "nav-link disabled");
    navItem.parentElement.setAttribute("class", "nav-item active");
    start(false);
}
function loadSubSite(name) {
    let xhttp = new XMLHttpRequest();
    xhttp.open("GET", "Resources/Subsites/" + name.toLowerCase() + ".html", true);
    xhttp.responseType = 'text';
    xhttp.send();
    xhttp.onreadystatechange = () => {
        if (xhttp.readyState == 4 && xhttp.status == 200) {
            let oldsubsite = document.getElementsByClassName("content").item(0);
            if (oldsubsite != null) {
                oldsubsite.remove();
            }
            document.getElementById("stickyHead").insertAdjacentHTML("afterend", xhttp.response);
        }
        else if (xhttp.status != 200) {
            console.log("HTTP Error " + xhttp.status + "\nwhile loading " + name.toLowerCase + ".html file");
        }
    };
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL1R5cGVzY3JpcHQvYmFja2VuZF9KUy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxrREFBa0Q7QUFDbEQsTUFBTSxPQUFPO0lBRVQ7SUFDQSxDQUFDO0lBRUQsd0VBQXdFO0lBQ2pFLE9BQU87UUFDVixJQUFJLEtBQUssR0FBbUIsSUFBSSxjQUFjLEVBQUUsQ0FBQztRQUNqRCxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSx3Q0FBd0MsRUFBRSxJQUFJLENBQUMsQ0FBQTtRQUNqRSxLQUFLLENBQUMsWUFBWSxHQUFHLE1BQU0sQ0FBQztRQUM1QixLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDYixLQUFLLENBQUMsa0JBQWtCLEdBQUcsR0FBRyxFQUFFO1lBQzVCLElBQUksS0FBSyxDQUFDLFVBQVUsSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDLE1BQU0sSUFBSSxHQUFHLEVBQUU7Z0JBQzlDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDdEMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFXLEVBQUUsR0FBVyxFQUFFLEVBQUU7b0JBQ2hELElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDO2dCQUNqQyxDQUFDLENBQUMsQ0FBQTthQUNMO2lCQUFNLElBQUksS0FBSyxDQUFDLE1BQU0sSUFBSSxHQUFHLEVBQUU7Z0JBQzVCLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO2FBQ2pDO1FBQ0wsQ0FBQyxDQUFBO0lBQ0wsQ0FBQztJQUVELDJFQUEyRTtJQUNuRSxZQUFZLENBQUMsSUFBVyxFQUFFLEdBQVc7UUFDekMsSUFBSSxPQUFPLEdBQW1CLElBQUksY0FBYyxFQUFFLENBQUM7UUFDbkQsSUFBSSxPQUFPLEdBQVksSUFBSSxDQUFDO1FBQzVCLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FB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QUFhLEdBQUcsS0FBSyxDQUFDLE1BQU0sR0FBRyxrQkFBa0IsR0FBRyxJQUFJLENBQUMsV0FBVyxHQUFHLFlBQVksQ0FBQyxDQUFDO1NBQ3BHO0lBQ0wsQ0FBQyxDQUFBO0FBQ0wsQ0FBQyIsImZpbGUiOiJiYWNrZW5kX0pTLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqIENsYXNzIGZvciBidWlsZGluZyBhIGNhcnVzZWwgb24gdGhlIHdlYnBhZ2UgKi9cbmNsYXNzIENhcnVzZWwge1xuXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKCkge1xuICAgIH1cblxuICAgIC8qKlN0YXJ0cyB0aGUgY2FydXNlbCBidWlsZCBhbmQgbG9hZHMgdGhlIEJpZ1Byb2plY3RzLUluZGV4Lmpzb24gZmlsZSAqL1xuICAgIHB1YmxpYyBjYXJ1c2VsKCkge1xuICAgICAgICBsZXQgeGh0dHA6IFhNTEh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIHhodHRwLm9wZW4oXCJHRVRcIiwgXCJSZXNvdXJjZXMvVGV4dHMvQmlnUHJvamVjdHMtSW5kZXguanNvblwiLCB0cnVlKVxuICAgICAgICB4aHR0cC5yZXNwb25zZVR5cGUgPSAnanNvbic7XG4gICAgICAgIHhodHRwLnNlbmQoKTtcbiAgICAgICAgeGh0dHAub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHhodHRwLnJlYWR5U3RhdGUgPT0gNCAmJiB4aHR0cC5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5idWlsZExpc3QoeGh0dHAucmVzcG9uc2UubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB4aHR0cC5yZXNwb25zZS5mb3JFYWNoKChpdGVtOiBpbmRleCwgcG9zOiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWFkTGlzdEl0ZW0oaXRlbSwgcG9zKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSBlbHNlIGlmICh4aHR0cC5zdGF0dXMgIT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coeGh0dHAucmVhZHlTdGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipyZWFkcyBlYWNoIGl0ZW0gb2YgQmlnUHJvamVjdHMtSW5kZXguanNvbiBhbmQgbG9hZHMgdGhlIGluZGV4ZWQgZmlsZXMgKi9cbiAgICBwcml2YXRlIHJlYWRMaXN0SXRlbShpdGVtOiBpbmRleCwgcG9zOiBudW1iZXIpIHtcbiAgICAgICAgbGV0IHJlcXVlc3Q6IFhNTEh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIGxldCBjaGFuZ2VkOiBib29sZWFuID0gdHJ1ZTtcbiAgICAgICAgcmVxdWVzdC5vcGVuKFwiR0VUXCIsIFwiIFJlc291cmNlcy9UZXh0cy9cIiArIGl0ZW0udGl0bGUgKyBcIi5qc29uXCIsIHRydWUpO1xuICAgICAgICByZXF1ZXN0LnJlc3BvbnNlVHlwZSA9ICdqc29uJztcbiAgICAgICAgcmVxdWVzdC5zZW5kKCk7XG4gICAgICAgIHJlcXVlc3Qub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlcXVlc3QucmVhZHlTdGF0ZSA9PSA0ICYmIHJlcXVlc3Quc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRDYXJvdXNlbChyZXF1ZXN0LnJlc3BvbnNlLCBwb3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqYnVpbGRzIHRoZSBvdmVydmlldyBvZiB0aGUgY2FydXNlbCovXG4gICAgcHJpdmF0ZSBidWlsZExpc3QobnVtYmVyOiBudW1iZXIpIHtcbiAgICAgICAgbGV0IHRleHQ6IHN0cmluZztcbiAgICAgICAgbGV0IGFjdGl2ZTogc3RyaW5nO1xuICAgICAgICB0ZXh0ID0gXCJcIjtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1iZXI7IGkrKykge1xuICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICBhY3RpdmUgPSAnIGNsYXNzPVwiYWN0aXZlXCInO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhY3RpdmUgPSAnIGNsYXNzJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRleHQgKz0gXCI8bGkgZGF0YS10YXJnZXQ9XFxcIiNteUNhcm91c2VsXFxcIiBkYXRhLXNsaWRlLXRvPVwiICsgaSArIGFjdGl2ZSArIFwiPjwvbGk+XCI7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY2Fyb3VzZWwtaW5kaWNhdG9yc1wiKS5pdGVtKDApO1xuICAgICAgICBlbGVtZW50Lmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsIHRleHQpO1xuICAgIH1cblxuICAgIC8qKnRha2VzIGVhY2ggcHJvamVjdCBmaWxlIGluZGV4dCBieSBCaWdQcm9qZWN0cy1JbmRleC5qc29uIGFuZCB0dXJucyB0aGVtIGludG8gYSBjYXJkIGZvciB0aGUgY2FydXNlbCBzbGlkZSAqL1xuICAgIHB1YmxpYyBidWlsZENhcm91c2VsKGNhcm91c2VsSXRlbXM6IHByb2plY3RzLCBwb3M6IG51bWJlcikge1xuICAgICAgICBsZXQgc3RyOiBzdHJpbmc7XG4gICAgICAgIGlmIChwb3MgPT09IDApIHtcbiAgICAgICAgICAgIHN0ciA9ICc8ZGl2IGNsYXNzPVwiY2Fyb3VzZWwtaXRlbSBhY3RpdmVcIj4nICsgXCJcXG5cIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0ciA9ICc8ZGl2IGNsYXNzPVwiY2Fyb3VzZWwtaXRlbVwiPicgKyBcIlxcblwiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYXJvdXNlbEl0ZW1zLmNvbG9yID09IG51bGwpIHtcbiAgICAgICAgICAgIGNhcm91c2VsSXRlbXMuY29sb3IgPSBcIiM3NzdcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2Fyb3VzZWxJdGVtcy5waWN0dXJlID09IG51bGwpIHtcbiAgICAgICAgICAgIHN0ciArPSAnPHN2ZyBjbGFzcz1cImJkLXBsYWNlaG9sZGVyLWltZ1wiIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgcHJlc2VydmVBc3BlY3RSYXRpbz1cInhNaWRZTWlkIHNsaWNlXFxcIiBmb2N1c2FibGU9XFxcImZhbHNlXFxcIiByb2xlPVxcXCJpbWdcXFwiPjxyZWN0IHdpZHRoPVxcXCIxMDAlXFxcIiBoZWlnaHQ9XFxcIjEwMCVcXFwiIGZpbGw9XCInICsgY2Fyb3VzZWxJdGVtcy5jb2xvciArICdcIi8+PC9zdmc+JyArIFwiXFxuXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdHIgKz0gJzxpbWcgY2xhc3M9XCJiZC1pbWdcIiB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCIxMDAlXCIgc3JjPVwiJyArIGNhcm91c2VsSXRlbXMucGljdHVyZSArICdcIi8+J1xuICAgICAgICB9XG4gICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz1cImNvbnRhaW5lclwiPicgKyBcIlxcblwiO1xuICAgICAgICBzdHIgKz0gJzxkaXYgY2xhc3M9XCJjYXJvdXNlbC1jYXB0aW9uIHRleHQtbGVmdFwiPicgKyBcIlxcblwiO1xuICAgICAgICBzdHIgKz0gXCI8aDE+XCIgKyBjYXJvdXNlbEl0ZW1zLnRpdGxlICsgXCI8L2gxPlwiICsgXCJcXG5cIjtcbiAgICAgICAgc3RyICs9IFwiPHA+XCIgKyBjYXJvdXNlbEl0ZW1zLmluZm8gKyBcIjwvcD5cIiArIFwiXFxuXCI7XG4gICAgICAgIGlmIChjYXJvdXNlbEl0ZW1zLmJ1dHRvbiA9PSB0cnVlKSB7XG4gICAgICAgICAgICBzdHIgKz0gJzxwPjxhIGNsYXNzPVwiYnRuIGJ0bi1sZyBidG4tcHJpbWFyeVwiIGhyZWY9XCInICsgY2Fyb3VzZWxJdGVtcy5saW5rICsgJ1wiIHJvbGU9XCJidXR0b25cIj4nICsgY2Fyb3VzZWxJdGVtcy5idXR0b25fcGljdHVyZSArIFwiIFwiICsgY2Fyb3VzZWxJdGVtcy5idXR0b25MaW5rc1RvICsgJzwvYT48L3A+JyArIFwiXFxuXCI7XG4gICAgICAgIH1cbiAgICAgICAgc3RyICs9IFwiPC9kaXY+XCIgKyBcIlxcblwiO1xuICAgICAgICBzdHIgKz0gXCI8L2Rpdj5cIiArIFwiXFxuXCI7XG4gICAgICAgIHN0ciArPSBcIjwvZGl2PlwiICsgXCJcXG5cIjtcbiAgICAgICAgdGhpcy5hZGRDYXJ1c2VsVG9IVE1MKHN0cilcbiAgICB9XG5cbiAgICAvKipBZGRzIHRoZSBodG1sIG9mIHRoZSBjYXJ1c2VsIHRvIHRoZSByZXN0IG9mIHRoZSBzaXRlICovXG4gICAgcHJpdmF0ZSBhZGRDYXJ1c2VsVG9IVE1MKGh0bWw6IHN0cmluZykge1xuICAgICAgICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2Fyb3VzZWwtZnJhbWVcIik7XG4gICAgICAgIC8vY29uc29sZS5sb2coaHRtbCk7XG4gICAgICAgIGVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIGh0bWwpO1xuICAgIH1cbn1cblxuLyoqQ2xhc3MgZm9yIGJ1aWxkaW5nIGEgbGlzdCBvZiBzbWFsbGVyIHByb2plY3RzIG9uIHRoZSB3ZWJwYWdlKi9cbmNsYXNzIFNtYWxsUHJvamVjdHMge1xuXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKCkge1xuICAgIH1cblxuICAgIHB1YmxpYyBzbWFsbFByb2plY3RzKCkge1xuICAgICAgICBsZXQgc3BSZXF1ZXN0OiBYTUxIdHRwUmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICBzcFJlcXVlc3Qub3BlbihcIkdFVFwiLCBcIlJlc291cmNlcy9UZXh0cy9TbWFsbFByb2plY3RzLUluZGV4Lmpzb25cIiwgdHJ1ZSlcbiAgICAgICAgc3BSZXF1ZXN0LnJlc3BvbnNlVHlwZSA9ICdqc29uJ1xuICAgICAgICBzcFJlcXVlc3Quc2VuZCgpO1xuICAgICAgICBzcFJlcXVlc3Qub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHNwUmVxdWVzdC5yZWFkeVN0YXRlID09IDQgJiYgc3BSZXF1ZXN0LnN0YXR1cyA9PSAyMDApIHtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHNwUmVxdWVzdC5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgc3BSZXF1ZXN0LnJlc3BvbnNlLmZvckVhY2goKGl0ZW06IGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coc3BSZXF1ZXN0KVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlYWRTbWFsbFByb2plY3RJbmRleChpdGVtKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgcmVhZFNtYWxsUHJvamVjdEluZGV4KGl0ZW06IGluZGV4KSB7XG4gICAgICAgIGxldCByZXF1ZXN0OiBYTUxIdHRwUmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICBsZXQgY2hhbmdlZDogYm9vbGVhbiA9IHRydWU7XG4gICAgICAgIHJlcXVlc3Qub3BlbihcIkdFVFwiLCBcIlJlc291cmNlcy9UZXh0cy9cIiArIGl0ZW0udGl0bGUgKyBcIi5qc29uXCIsIHRydWUpO1xuICAgICAgICByZXF1ZXN0LnJlc3BvbnNlVHlwZSA9ICdqc29uJztcbiAgICAgICAgcmVxdWVzdC5zZW5kKCk7XG4gICAgICAgIHJlcXVlc3Qub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlcXVlc3QucmVhZHlTdGF0ZSA9PSA0ICYmIHJlcXVlc3Quc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRTbWFsbFByb2plY3RzKHJlcXVlc3QucmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkU21hbGxQcm9qZWN0cyhzbWFsbFByb2plY3Q6IHByb2plY3RzKSB7XG4gICAgICAgIGxldCBzdHI6IHN0cmluZztcbiAgICAgICAgc3RyID0gJzxkaXYgY2xhc3M9XCJjb2wtbGctNFwiPicgKyBcIlxcblwiO1xuICAgICAgICBpZiAoc21hbGxQcm9qZWN0LmNvbG9yID09IG51bGwpIHtcbiAgICAgICAgICAgIHNtYWxsUHJvamVjdC5jb2xvciA9IFwiIzc3N1wiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzbWFsbFByb2plY3QucGljdHVyZSA9PSBudWxsKSB7XG4gICAgICAgICAgICBzdHIgKz0gJzxzdmcgY2xhc3M9XCJiZC1wbGFjZWhvbGRlci1pbWcgcm91bmRlZC1jaXJjbGVcIiB3aWR0aD1cIjE0MFwiIGhlaWdodD1cIjE0MFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPVwieE1pZFlNaWQgc2xpY2VcIiBmb2N1c2FibGU9XCJmYWxzZVwiIHJvbGU9XCJpbWdcIiBhcmlhLWxhYmVsPVwiUGxhY2Vob2xkZXI6IDE0MHgxNDBcIj4nICsgXCJcXG5cIlxuICAgICAgICAgICAgc3RyICs9ICc8dGl0bGU+UGxhY2Vob2xkZXI8L3RpdGxlPicgKyBcIlxcblwiXG4gICAgICAgICAgICBzdHIgKz0gJzxyZWN0IHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIiBmaWxsPVwiJyArIHNtYWxsUHJvamVjdC5jb2xvciArICdcIi8+JyArIFwiXFxuXCI7XG4gICAgICAgICAgICBzdHIgKz0gJzx0ZXh0IGNsYXNzPVwicGxhY2Vob2xkZXJcIiBmb250LXNpemU9XCI0NVwiIHRleHQtYW5jaG9yPVwibWlkZGxlXCIgYWxpZ25tZW50LWJhc2VsaW5lPVwiY2VudHJhbFwiIGZpbGw9XCIjZmZmXCI+IDx0c3BhbiB4PVwiNTAlXCIgZHk9XCI2MCVcIj4nICsgc21hbGxQcm9qZWN0LnNob3J0ICsgJzwvdHNwYW4+PC90ZXh0Pjwvc3ZnPidcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0ciArPSAnPGltZyBjbGFzcz1cImJkLWltZyByb3VuZGVkLWNpcmNsZVwiIHdpZHRoPVwiMTQwXCIgaGVpZ2h0PVwiMTQwXCIgc3JjPScgKyBzbWFsbFByb2plY3QucGljdHVyZSArICdcIiBhbHQ9XCInICsgc21hbGxQcm9qZWN0LnNob3J0ICsgJ1wiLz4nXG4gICAgICAgIH1cbiAgICAgICAgc3RyICs9IFwiPGgyPlwiICsgc21hbGxQcm9qZWN0LnRpdGxlICsgXCI8L2gyPlwiICsgXCJcXG5cIjtcbiAgICAgICAgc3RyICs9IFwiPHA+XCIgKyBzbWFsbFByb2plY3QuaW5mbyArIFwiPC9wPlwiICsgXCJcXG5cIjtcbiAgICAgICAgaWYgKHNtYWxsUHJvamVjdC5idXR0b24gPT0gdHJ1ZSAmJiBzbWFsbFByb2plY3QuYnV0dG9uX3BpY3R1cmUgIT0gbnVsbCkge1xuICAgICAgICAgICAgc3RyICs9ICc8cD48YSBjbGFzcz1cImJ0biBidG4tc2Vjb25kYXJ5XCIgaHJlZj0nICsgc21hbGxQcm9qZWN0LmxpbmsgKyAnIHJvbGU9XCJidXR0b25cIj4nICsgc21hbGxQcm9qZWN0LmJ1dHRvbl9waWN0dXJlICsgXCIgXCIgKyBzbWFsbFByb2plY3QuYnV0dG9uTGlua3NUbyArICc8L2E+PC9wPicgKyBcIlxcblwiO1xuICAgICAgICB9IGVsc2UgaWYgKHNtYWxsUHJvamVjdC5idXR0b24gPT0gdHJ1ZSkge1xuICAgICAgICAgICAgc3RyICs9ICc8cD48YSBjbGFzcz1cImJ0biBidG4tc2Vjb25kYXJ5XCIgaHJlZj0nICsgc21hbGxQcm9qZWN0LmxpbmsgKyAnIHJvbGU9XCJidXR0b25cIj4nICsgc21hbGxQcm9qZWN0LmJ1dHRvbkxpbmtzVG8gKyAnPC9hPjwvcD4nICsgXCJcXG5cIjtcbiAgICAgICAgfVxuICAgICAgICBzdHIgKz0gXCI8L2Rpdj5cIiArIFwiXFxuXCI7XG4gICAgICAgIHRoaXMuYWRkU21hbGxQcm9qZWN0VG9IVE1MKHN0cilcbiAgICB9XG5cblxuICAgIHByaXZhdGUgYWRkU21hbGxQcm9qZWN0VG9IVE1MKGh0bWw6IHN0cmluZykge1xuICAgICAgICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3BcIik7XG4gICAgICAgIC8vY29uc29sZS5sb2coaHRtbCk7XG4gICAgICAgIGVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIGh0bWwpO1xuICAgIH1cbn1cblxuLyogSURFQSBjaGFuZ2Ugc2NyaXB0IHRvIGxvYWQvdW5sb2FkIGNvbnRlbnQgdW5kZXIgdGhlIGhlYWRlciBzbyBpIGNhbiB1c2UgYSBzaW5nbGUgdXJsP1xuICogXG4gKi9cblxuXG4vKk1BSU4qL1xubGV0IGNhcnVzZWw6IENhcnVzZWwgPSBuZXcgQ2FydXNlbDtcbmxldCBzbWFsbFByb2plY3RzOiBTbWFsbFByb2plY3RzID0gbmV3IFNtYWxsUHJvamVjdHM7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIGZ1bmN0aW9uICgpIHtcbn0sIHRydWUpO1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4ge1xuICAgIHN0YXJ0KHRydWUpXG59KTtcblxuZnVuY3Rpb24gc3RhcnQoZmlyc3RSdW46IGJvb2xlYW4pIHtcbiAgICBpZiAoZmlyc3RSdW4pIHtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJQcm9qZWN0c1wiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2hhbmdlQWN0aXZOYXZJdGVtKTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJTa2lsbHNcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNoYW5nZUFjdGl2TmF2SXRlbSk7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiQ29udGFjdFwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2hhbmdlQWN0aXZOYXZJdGVtKTtcbiAgICB9XG5cbiAgICBsZXQgYWN0aXZOYXZJdGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcIm5hdi1pdGVtIGFjdGl2ZVwiKVswXS5jaGlsZHJlblswXS50ZXh0Q29udGVudFxuICAgIGlmIChhY3Rpdk5hdkl0ZW0gPT0gXCJQcm9qZWN0c1wiKSB7XG4gICAgICAgIGxvYWRTdWJTaXRlKGFjdGl2TmF2SXRlbSk7XG4gICAgICAgIGNhcnVzZWwuY2FydXNlbCgpO1xuICAgICAgICBzbWFsbFByb2plY3RzLnNtYWxsUHJvamVjdHMoKTtcbiAgICB9IGVsc2UgaWYgKGFjdGl2TmF2SXRlbSA9PSBcIlNraWxsc1wiKSB7XG4gICAgICAgIGxvYWRTdWJTaXRlKGFjdGl2TmF2SXRlbSlcblxuICAgIH0gZWxzZSBpZiAoYWN0aXZOYXZJdGVtID09IFwiQ29udGFjdFwiKSB7XG4gICAgICAgIGxvYWRTdWJTaXRlKGFjdGl2TmF2SXRlbSlcbiAgICB9XG59XG5cbi8qKiBDaGFuZ2VzIHRoZSBhY3RpdmUgTmF2SXRlbSB0byB0aGUgY2xpY2tlZCBvbmUqL1xuZnVuY3Rpb24gY2hhbmdlQWN0aXZOYXZJdGVtKGU6IEV2ZW50KSB7XG4gICAgLy9AdHMtaWdub3JlXG4gICAgbGV0IG5hdkl0ZW06IEhUTUxFbGVtZW50ID0gZS5jdXJyZW50VGFyZ2V0O1xuICAgIGxldCBhY3Rpdk5hdkl0ZW06IEhUTUxDb2xsZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcIm5hdi1pdGVtIGFjdGl2ZVwiKVxuICAgIGlmIChhY3Rpdk5hdkl0ZW0ubGVuZ3RoIDw9IDEpIHtcbiAgICAgICAgYWN0aXZOYXZJdGVtWzBdLmNoaWxkcmVuWzBdLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibmF2LWxpbmtcIik7XG4gICAgICAgIGFjdGl2TmF2SXRlbVswXS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcIm5hdi1pdGVtXCIpO1xuICAgIH1cbiAgICBuYXZJdGVtLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibmF2LWxpbmsgZGlzYWJsZWRcIik7XG4gICAgbmF2SXRlbS5wYXJlbnRFbGVtZW50LnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibmF2LWl0ZW0gYWN0aXZlXCIpO1xuICAgIHN0YXJ0KGZhbHNlKTtcbn1cblxuZnVuY3Rpb24gbG9hZFN1YlNpdGUobmFtZTogU3RyaW5nKSB7XG4gICAgbGV0IHhodHRwOiBYTUxIdHRwUmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHhodHRwLm9wZW4oXCJHRVRcIiwgXCJSZXNvdXJjZXMvU3Vic2l0ZXMvXCIgKyBuYW1lLnRvTG93ZXJDYXNlKCkgKyBcIi5odG1sXCIsIHRydWUpXG4gICAgeGh0dHAucmVzcG9uc2VUeXBlID0gJ3RleHQnO1xuICAgIHhodHRwLnNlbmQoKTtcbiAgICB4aHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgIGlmICh4aHR0cC5yZWFkeVN0YXRlID09IDQgJiYgeGh0dHAuc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgbGV0IG9sZHN1YnNpdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29udGVudFwiKS5pdGVtKDApO1xuICAgICAgICAgICAgaWYgKG9sZHN1YnNpdGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG9sZHN1YnNpdGUucmVtb3ZlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RpY2t5SGVhZFwiKS5pbnNlcnRBZGphY2VudEhUTUwoXCJhZnRlcmVuZFwiLCB4aHR0cC5yZXNwb25zZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoeGh0dHAuc3RhdHVzICE9IDIwMCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJIVFRQIEVycm9yIFwiICsgeGh0dHAuc3RhdHVzICsgXCJcXG53aGlsZSBsb2FkaW5nIFwiICsgbmFtZS50b0xvd2VyQ2FzZSArIFwiLmh0bWwgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqIE9iamVjdHR5cGVzIGZyb20gdGhlIEpTT05TICovXG5cbmludGVyZmFjZSBwcm9qZWN0cyB7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICBzaG9ydDogc3RyaW5nO1xuICAgIGluZm86IHN0cmluZztcbiAgICBwaWN0dXJlOiBzdHJpbmc7XG4gICAgY29sb3I6IHN0cmluZztcbiAgICBidXR0b246IGJvb2xlYW47XG4gICAgYnV0dG9uX3BpY3R1cmU6IHN0cmluZztcbiAgICBidXR0b25MaW5rc1RvOiBzdHJpbmc7XG4gICAgbGluazogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgaW5kZXgge1xuICAgIHRpdGxlOiBzdHJpbmc7XG59Il19
