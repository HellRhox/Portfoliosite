/** Class for building a carusel on the webpage */
class Carusel {
    constructor() {
    }
    /**Starts the carusel build and loads the BigProjects-Index.json file */
    carusel() {
        let xhttp = new XMLHttpRequest();
        xhttp.open("GET", "Resources/Texts/BigProjects-Index.json", true);
        xhttp.responseType = 'json';
        xhttp.send();
        xhttp.onreadystatechange = () => {
            if (xhttp.readyState == 4 && xhttp.status == 200) {
                this.buildList(xhttp.response.length);
                xhttp.response.forEach((item, pos) => {
                    this.readListItem(item, pos);
                });
            }
            else if (xhttp.status != 200) {
                console.log(xhttp.readyState);
            }
        };
    }
    /**reads each item of BigProjects-Index.json and loads the indexed files */
    readListItem(item, pos) {
        let request = new XMLHttpRequest();
        let changed = true;
        request.open("GET", " Resources/Texts/" + item.title + ".json", true);
        request.responseType = 'json';
        request.send();
        request.onreadystatechange = () => {
            if (request.readyState == 4 && request.status == 200) {
                this.buildCarousel(request.response, pos);
            }
        };
    }
    /**builds the overview of the carusel*/
    buildList(number) {
        let text;
        let active;
        text = "";
        for (let i = 0; i < number; i++) {
            if (i === 0) {
                active = ' class="active"';
            }
            else {
                active = ' class';
            }
            text += "<li data-target=\"#myCarousel\" data-slide-to=" + i + active + "></li>";
        }
        let element = document.getElementsByClassName("carousel-indicators").item(0);
        element.insertAdjacentHTML('afterbegin', text);
    }
    /**takes each project file indext by BigProjects-Index.json and turns them into a card for the carusel slide */
    buildCarousel(carouselItems, pos) {
        let str;
        if (pos === 0) {
            str = '<div class="carousel-item active">' + "\n";
        }
        else {
            str = '<div class="carousel-item">' + "\n";
        }
        if (carouselItems.color == null) {
            carouselItems.color = "#777";
        }
        if (carouselItems.picture == null) {
            str += '<svg class="bd-placeholder-img" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice\" focusable=\"false\" role=\"img\"><rect width=\"100%\" height=\"100%\" fill="' + carouselItems.color + '"/></svg>' + "\n";
        }
        else {
            str += '<img class="bd-img" width="100%" height="100%" src="' + carouselItems.picture + '"/>';
        }
        str += '<div class="container">' + "\n";
        str += '<div class="carousel-caption text-left">' + "\n";
        str += "<h1>" + carouselItems.title + "</h1>" + "\n";
        str += "<p>" + carouselItems.info + "</p>" + "\n";
        if (carouselItems.button == true) {
            str += '<p class="buttonContainer"><a class="btn btn-lg btn-primary" href="' + carouselItems.link + '" role="button">' + carouselItems.button_picture + " " + carouselItems.buttonLinksTo + '</a></p>' + "\n";
        }
        str += "</div>" + "\n";
        str += "</div>" + "\n";
        str += "</div>" + "\n";
        this.addCaruselToHTML(str);
    }
    /**Adds the html of the carusel to the rest of the site */
    addCaruselToHTML(html) {
        let element = document.getElementById("carousel-frame");
        //console.log(html);
        element.insertAdjacentHTML("beforeend", html);
    }
}
/**Class for building a list of smaller projects on the webpage*/
class SmallProjects {
    constructor() {
    }
    smallProjects() {
        let spRequest = new XMLHttpRequest();
        spRequest.open("GET", "Resources/Texts/SmallProjects-Index.json", true);
        spRequest.responseType = 'json';
        spRequest.send();
        spRequest.onreadystatechange = () => {
            if (spRequest.readyState == 4 && spRequest.status == 200) {
                //console.log(spRequest.response);
                spRequest.response.forEach((item) => {
                    //console.log(spRequest)
                    this.readSmallProjectIndex(item);
                });
            }
        };
    }
    readSmallProjectIndex(item) {
        let request = new XMLHttpRequest();
        let changed = true;
        request.open("GET", "Resources/Texts/" + item.title + ".json", true);
        request.responseType = 'json';
        request.send();
        request.onreadystatechange = () => {
            if (request.readyState == 4 && request.status == 200) {
                this.buildSmallProjects(request.response);
            }
        };
    }
    buildSmallProjects(smallProject) {
        let str;
        str = '<div class="col-lg-4">' + "\n";
        if (smallProject.color == null) {
            smallProject.color = "#777";
        }
        if (smallProject.picture == null) {
            str += '<svg class="bd-placeholder-img rounded-circle" width="140" height="140" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: 140x140">' + "\n";
            str += '<title>Placeholder</title>' + "\n";
            str += '<rect width="100%" height="100%" fill="' + smallProject.color + '"/>' + "\n";
            str += '<text class="placeholder" font-size="45" text-anchor="middle" alignment-baseline="central" fill="#fff"> <tspan x="50%" dy="60%">' + smallProject.short + '</tspan></text></svg>';
        }
        else {
            str += '<img class="bd-img rounded-circle" width="140" height="140" src=' + smallProject.picture + '" alt="' + smallProject.short + '"/>';
        }
        str += "<h2>" + smallProject.title + "</h2>" + "\n";
        str += "<p>" + smallProject.info + "</p>" + "\n";
        if (smallProject.button == true && smallProject.button_picture != null) {
            str += '<p><a class="btn btn-secondary" href=' + smallProject.link + ' role="button">' + smallProject.button_picture + " " + smallProject.buttonLinksTo + '</a></p>' + "\n";
        }
        else if (smallProject.button == true) {
            str += '<p><a class="btn btn-secondary" href=' + smallProject.link + ' role="button">' + smallProject.buttonLinksTo + '</a></p>' + "\n";
        }
        str += "</div>" + "\n";
        this.addSmallProjectToHTML(str);
    }
    addSmallProjectToHTML(html) {
        let element = document.getElementById("sp");
        //console.log(html);
        element.insertAdjacentHTML("beforeend", html);
    }
}
/* IDEA change script to load/unload content under the header so i can use a single url?
 *
 */
/*MAIN*/
let carusel = new Carusel;
let smallProjects = new SmallProjects;
document.addEventListener("touchstart", function () {
}, true);
document.addEventListener("DOMContentLoaded", () => {
    start(true);
});
function start(firstRun) {
    if (firstRun) {
        document.getElementById("Projects").addEventListener("click", changeActivNavItem);
        document.getElementById("Skills").addEventListener("click", changeActivNavItem);
        document.getElementById("Contact").addEventListener("click", changeActivNavItem);
    }
    let activNavItem = document.getElementsByClassName("nav-item active")[0].children[0].textContent;
    if (activNavItem == "Projects") {
        loadSubSite(activNavItem);
        carusel.carusel();
        smallProjects.smallProjects();
    }
    else if (activNavItem == "Skills") {
        loadSubSite(activNavItem);
    }
    else if (activNavItem == "Contact") {
        loadSubSite(activNavItem);
    }
}
/** Changes the active NavItem to the clicked one*/
function changeActivNavItem(e) {
    //@ts-ignore
    let navItem = e.currentTarget;
    let activNavItem = document.getElementsByClassName("nav-item active");
    if (activNavItem.length <= 1) {
        activNavItem[0].children[0].setAttribute("class", "nav-link");
        activNavItem[0].setAttribute("class", "nav-item");
    }
    navItem.setAttribute("class", "nav-link disabled");
    navItem.parentElement.setAttribute("class", "nav-item active");
    start(false);
}
function loadSubSite(name) {
    let xhttp = new XMLHttpRequest();
    xhttp.open("GET", "Resources/Subsites/" + name.toLowerCase() + ".html", true);
    xhttp.responseType = 'text';
    xhttp.send();
    xhttp.onreadystatechange = () => {
        if (xhttp.readyState == 4 && xhttp.status == 200) {
            let oldsubsite = document.getElementsByClassName("content").item(0);
            if (oldsubsite != null) {
                oldsubsite.remove();
            }
            document.getElementById("stickyHead").insertAdjacentHTML("afterend", xhttp.response);
        }
        else if (xhttp.status != 200) {
            console.log("HTTP Error " + xhttp.status + "\nwhile loading " + name.toLowerCase + ".html file");
        }
    };
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL1R5cGVzY3JpcHQvYmFja2VuZF9KUy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxrREFBa0Q7QUFDbEQsTUFBTSxPQUFPO0lBRVQ7SUFDQSxDQUFDO0lBRUQsd0VBQXdFO0lBQ2pFLE9BQU87UUFDVixJQUFJLEtBQUssR0FBbUIsSUFBSSxjQUFjLEVBQUUsQ0FBQztRQUNqRCxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSx3Q0FBd0MsRUFBRSxJQUFJLENBQUMsQ0FBQTtRQUNqRSxLQUFLLENBQUMsWUFBWSxHQUFHLE1BQU0sQ0FBQztRQUM1QixLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDYixLQUFLLENBQUMsa0JBQWtCLEdBQUcsR0FBRyxFQUFFO1lBQzVCLElBQUksS0FBSyxDQUFDLFVBQVUsSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDLE1BQU0sSUFBSSxHQUFHLEVBQUU7Z0JBQzlDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDdEMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFXLEVBQUUsR0FBVyxFQUFFLEVBQUU7b0JBQ2hELElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDO2dCQUNqQyxDQUFDLENBQUMsQ0FBQTthQUNMO2lCQUFNLElBQUksS0FBSyxDQUFDLE1BQU0sSUFBSSxHQUFHLEVBQUU7Z0JBQzVCLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO2FBQ2pDO1FBQ0wsQ0FBQyxDQUFBO0lBQ0wsQ0FBQztJQUVELDJFQUEyRTtJQUNuRSxZQUFZLENBQUMsSUFBVyxFQUFFLEdBQVc7UUFDekMsSUFBSSxPQUFPLEdBQW1CLElBQUksY0FBYyxFQUFFLENBQUM7UUFDbkQsSUFBSSxPQUFPLEdBQVksSUFBSSxDQUFDO1FBQzVCLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLG1CQUFtQixHQUFHLElBQUksQ0FBQyxLQUFLLEdBQUcsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3RFLE9BQU8sQ0FBQyxZQUFZLEdBQUcsTUFBTSxDQUFDO1FBQzlCLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNmLE9BQU8sQ0FBQyxrQkFBa0IsR0FBRyxHQUFHLEVBQUU7WUFDOUIsSUFBSSxPQUFPLENBQUMsVUFBVSxJQUFJLENBQUMsSUFBSSxPQUFPLENBQUMsTUFBTSxJQUFJLEdBQUcsRUFBRTtnQkFDbEQsSUFBSSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFDO2FBQzdDO1FBQ0wsQ0FBQyxDQUFBO0lBQ0wsQ0FBQztJQUVELHVDQUF1QztJQUMvQixTQUFTLENBQUMsTUFBYztRQUM1QixJQUFJLElBQVksQ0FBQztRQUNqQixJQUFJLE1BQWMsQ0FBQztRQUNuQixJQUFJLEdBQUcsRUFBRSxDQUFDO1FBQ1YsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUM3QixJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQ1QsTUFBTSxHQUFHLGlCQUFpQixDQUFDO2FBQzlCO2lCQUFNO2dCQUNILE1BQU0sR0FBRyxRQUFRLENBQUM7YUFDckI7WUFDRCxJQUFJLElBQUksZ0RBQWdELEdBQUcsQ0FBQyxHQUFHLE1BQU0sR0FBRyxRQUFRLENBQUM7U0FDcEY7UUFDRCxJQUFJLE9BQU8sR0FBRyxRQUFRLENBQUMsc0JBQXNCLENBQUMscUJBQXFCLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDN0UsT0FBTyxDQUFDLGtCQUFrQixDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNuRCxDQUFDO0lBRUQsK0dBQStHO0lBQ3hHLGFBQWEsQ0FBQyxhQUF1QixFQUFFLEdBQVc7UUFDckQsSUFBSSxHQUFXLENBQUM7UUFDaEIsSUFBSSxHQUFHLEtBQUssQ0FBQyxFQUFFO1lBQ1gsR0FBRyxHQUFHLG9DQUFvQyxHQUFHLElBQUksQ0FBQztTQUNyRDthQUFNO1lBQ0gsR0FBRyxHQUFHLDZCQUE2QixHQUFHLElBQUksQ0FBQztTQUM5QztRQUNELElBQUksYUFBYSxDQUFDLEtBQUssSUFBSSxJQUFJLEVBQUU7WUFDN0IsYUFBYSxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUM7U0FDaEM7UUFDRCxJQUFJLGFBQWEsQ0FBQyxPQUFPLElBQUksSUFBSSxFQUFFO1lBQy9CLEdBQUcsSUFBSSxrTkFBa04sR0FBRyxhQUFhLENBQUMsS0FBSyxHQUFHLFdBQVcsR0FBRyxJQUFJLENBQUM7U0FDeFE7YUFBTTtZQUNILEdBQUcsSUFBSSxzREFBc0QsR0FBRyxhQUFhLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQTtTQUNoRztRQUNELEdBQUcsSUFBSSx5QkFBeUIsR0FBRyxJQUFJLENBQUM7UUFDeEMsR0FBRyxJQUFJLDBDQUEwQyxHQUFHLElBQUksQ0FBQztRQUN6RCxHQUFHLElBQUksTUFBTSxHQUFHLGFBQWEsQ0FBQyxLQUFLLEdBQUcsT0FBTyxHQUFHLElBQUksQ0FBQztRQUNyRCxHQUFHLElBQUksS0FBSyxHQUFHLGFBQWEsQ0FBQyxJQUFJLEdBQUcsTUFBTSxHQUFHLElBQUksQ0FBQztRQUNsRCxJQUFJLGFBQWEsQ0FBQyxNQUFNLElBQUksSUFBSSxFQUFFO1lBQzlCLEdBQUcsSUFBSSxxRUFBcUUsR0FBRyxhQUFhLENBQUMsSUFBSSxHQUFHLGtCQUFrQixHQUFHLGFBQWEsQ0FBQyxjQUFjLEdBQUcsR0FBRyxHQUFHLGFBQWEsQ0FBQyxhQUFhLEdBQUcsVUFBVSxHQUFHLElBQUksQ0FBQztTQUNqTjtRQUNELEdBQUcsSUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDO1FBQ3ZCLEdBQUcsSUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDO1FBQ3ZCLEdBQUcsSUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsQ0FBQTtJQUM5QixDQUFDO0lBRUQsMERBQTBEO0lBQ2xELGdCQUFnQixDQUFDLElBQVk7UUFDakMsSUFBSSxPQUFPLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQ3hELG9CQUFvQjtRQUNwQixPQUFPLENBQUMsa0JBQWtCLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ2xELENBQUM7Q0FDSjtBQUVELGlFQUFpRTtBQUNqRSxNQUFNLGFBQWE7SUFFZjtJQUNBLENBQUM7SUFFTSxhQUFhO1FBQ2hCLElBQUksU0FBUyxHQUFtQixJQUFJLGNBQWMsRUFBRSxDQUFDO1FBQ3JELFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLDBDQUEwQyxFQUFFLElBQUksQ0FBQyxDQUFBO1FBQ3ZFLFNBQVMsQ0FBQyxZQUFZLEdBQUcsTUFBTSxDQUFBO1FBQy9CLFNBQVMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNqQixTQUFTLENBQUMsa0JBQWtCLEdBQUcsR0FBRyxFQUFFO1lBQ2hDLElBQUksU0FBUyxDQUFDLFVBQVUsSUFBSSxDQUFDLElBQUksU0FBUyxDQUFDLE1BQU0sSUFBSSxHQUFHLEVBQUU7Z0JBQ3RELGtDQUFrQztnQkFDbEMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFXLEVBQUUsRUFBRTtvQkFDdkMsd0JBQXdCO29CQUN4QixJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ3JDLENBQUMsQ0FBQyxDQUFDO2FBQ047UUFDTCxDQUFDLENBQUE7SUFDTCxDQUFDO0lBRU8scUJBQXFCLENBQUMsSUFBVztRQUNyQyxJQUFJLE9BQU8sR0FBbUIsSUFBSSxjQUFjLEVBQUUsQ0FBQztRQUNuRCxJQUFJLE9BQU8sR0FBWSxJQUFJLENBQUM7UUFDNUIsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsa0JBQWtCLEdBQUcsSUFBSSxDQUFDLEtBQUssR0FBRyxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDckUsT0FBTyxDQUFDLFlBQVksR0FBRyxNQUFNLENBQUM7UUFDOUIsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ2YsT0FBTyxDQUFDLGtCQUFrQixHQUFHLEdBQUcsRUFBRTtZQUM5QixJQUFJLE9BQU8sQ0FBQyxVQUFVLElBQUksQ0FBQyxJQUFJLE9BQU8sQ0FBQyxNQUFNLElBQUksR0FBRyxFQUFFO2dCQUNsRCxJQUFJLENBQUMsa0JBQWtCLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO2FBQzdDO1FBQ0wsQ0FBQyxDQUFBO0lBRUwsQ0FBQztJQUVPLGtCQUFrQixDQUFDLFlBQXNCO1FBQzdDLElBQUksR0FBVyxDQUFDO1FBQ2hCLEdBQUcsR0FBRyx3QkFBd0IsR0FBRyxJQUFJLENBQUM7UUFDdEMsSUFBSSxZQUFZLENBQUMsS0FBSyxJQUFJLElBQUksRUFBRTtZQUM1QixZQUFZLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQztTQUMvQjtRQUNELElBQUksWUFBWSxDQUFDLE9BQU8sSUFBSSxJQUFJLEVBQUU7WUFDOUIsR0FBRyxJQUFJLGlOQUFpTixHQUFHLElBQUksQ0FBQTtZQUMvTixHQUFHLElBQUksNEJBQTRCLEdBQUcsSUFBSSxDQUFBO1lBQzFDLEdBQUcsSUFBSSx5Q0FBeUMsR0FBRyxZQUFZLENBQUMsS0FBSyxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUM7WUFDckYsR0FBRyxJQUFJLGtJQUFrSSxHQUFHLFlBQVksQ0FBQyxLQUFLLEdBQUcsdUJBQXVCLENBQUE7U0FDM0w7YUFBTTtZQUNILEdBQUcsSUFBSSxrRUFBa0UsR0FBRyxZQUFZLENBQUMsT0FBTyxHQUFHLFNBQVMsR0FBRyxZQUFZLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQTtTQUM1STtRQUNELEdBQUcsSUFBSSxNQUFNLEdBQUcsWUFBWSxDQUFDLEtBQUssR0FBRyxPQUFPLEdBQUcsSUFBSSxDQUFDO1FBQ3BELEdBQUcsSUFBSSxLQUFLLEdBQUcsWUFBWSxDQUFDLElBQUksR0FBRyxNQUFNLEdBQUcsSUFBSSxDQUFDO1FBQ2pELElBQUksWUFBWSxDQUFDLE1BQU0sSUFBSSxJQUFJLElBQUksWUFBWSxDQUFDLGNBQWMsSUFBSSxJQUFJLEVBQUU7WUFDcEUsR0FBRyxJQUFJLHVDQUF1QyxHQUFHLFlBQVksQ0FBQyxJQUFJLEdBQUcsaUJBQWlCLEdBQUcsWUFBWSxDQUFDLGNBQWMsR0FBRyxHQUFHLEdBQUcsWUFBWSxDQUFDLGFBQWEsR0FBRyxVQUFVLEdBQUcsSUFBSSxDQUFDO1NBQy9LO2FBQU0sSUFBSSxZQUFZLENBQUMsTUFBTSxJQUFJLElBQUksRUFBRTtZQUNwQyxHQUFHLElBQUksdUNBQXVDLEdBQUcsWUFBWSxDQUFDLElBQUksR0FBRyxpQkFBaUIsR0FBRyxZQUFZLENBQUMsYUFBYSxHQUFHLFVBQVUsR0FBRyxJQUFJLENBQUM7U0FDM0k7UUFDRCxHQUFHLElBQUksUUFBUSxHQUFHLElBQUksQ0FBQztRQUN2QixJQUFJLENBQUMscUJBQXFCLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDbkMsQ0FBQztJQUdPLHFCQUFxQixDQUFDLElBQVk7UUFDdEMsSUFBSSxPQUFPLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM1QyxvQkFBb0I7UUFDcEIsT0FBTyxDQUFDLGtCQUFrQixDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNsRCxDQUFDO0NBQ0o7QUFFRDs7R0FFRztBQUdILFFBQVE7QUFDUixJQUFJLE9BQU8sR0FBWSxJQUFJLE9BQU8sQ0FBQztBQUNuQyxJQUFJLGFBQWEsR0FBa0IsSUFBSSxhQUFhLENBQUM7QUFFckQsUUFBUSxDQUFDLGdCQUFnQixDQUFDLFlBQVksRUFBRTtBQUN4QyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDVCxRQUFRLENBQUMsZ0JBQWdCLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO0lBQy9DLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQTtBQUNmLENBQUMsQ0FBQyxDQUFDO0FBRUgsU0FBUyxLQUFLLENBQUMsUUFBaUI7SUFDNUIsSUFBSSxRQUFRLEVBQUU7UUFDVixRQUFRLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxrQkFBa0IsQ0FBQyxDQUFDO1FBQ2xGLFFBQVEsQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLGtCQUFrQixDQUFDLENBQUM7UUFDaEYsUUFBUSxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsa0JBQWtCLENBQUMsQ0FBQztLQUNwRjtJQUVELElBQUksWUFBWSxHQUFHLFFBQVEsQ0FBQyxzQkFBc0IsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUE7SUFDaEcsSUFBSSxZQUFZLElBQUksVUFBVSxFQUFFO1FBQzVCLFdBQVcsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUMxQixPQUFPLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDbEIsYUFBYSxDQUFDLGFBQWEsRUFBRSxDQUFDO0tBQ2pDO1NBQU0sSUFBSSxZQUFZLElBQUksUUFBUSxFQUFFO1FBQ2pDLFdBQVcsQ0FBQyxZQUFZLENBQUMsQ0FBQTtLQUU1QjtTQUFNLElBQUksWUFBWSxJQUFJLFNBQVMsRUFBRTtRQUNsQyxXQUFXLENBQUMsWUFBWSxDQUFDLENBQUE7S0FDNUI7QUFDTCxDQUFDO0FBRUQsbURBQW1EO0FBQ25ELFNBQVMsa0JBQWtCLENBQUMsQ0FBUTtJQUNoQyxZQUFZO0lBQ1osSUFBSSxPQUFPLEdBQWdCLENBQUMsQ0FBQyxhQUFhLENBQUM7SUFDM0MsSUFBSSxZQUFZLEdBQW1CLFFBQVEsQ0FBQyxzQkFBc0IsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFBO0lBQ3JGLElBQUksWUFBWSxDQUFDLE1BQU0sSUFBSSxDQUFDLEVBQUU7UUFDMUIsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBQzlELFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0tBQ3JEO0lBQ0QsT0FBTyxDQUFDLFlBQVksQ0FBQyxPQUFPLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztJQUNuRCxPQUFPLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxPQUFPLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztJQUMvRCxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDakIsQ0FBQztBQUVELFNBQVMsV0FBVyxDQUFDLElBQVk7SUFDN0IsSUFBSSxLQUFLLEdBQW1CLElBQUksY0FBYyxFQUFFLENBQUM7SUFDakQsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUscUJBQXFCLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxHQUFHLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQTtJQUM3RSxLQUFLLENBQUMsWUFBWSxHQUFHLE1BQU0sQ0FBQztJQUM1QixLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDYixLQUFLLENBQUMsa0JBQWtCLEdBQUcsR0FBRyxFQUFFO1FBQzVCLElBQUksS0FBSyxDQUFDLFVBQVUsSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDLE1BQU0sSUFBSSxHQUFHLEVBQUU7WUFDOUMsSUFBSSxVQUFVLEdBQUcsUUFBUSxDQUFDLHNCQUFzQixDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNwRSxJQUFJLFVBQVUsSUFBSSxJQUFJLEVBQUU7Z0JBQ3BCLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQTthQUN0QjtZQUNELFFBQVEsQ0FBQyxjQUFjLENBQUMsWUFBWSxDQUFDLENBQUMsa0JBQWtCLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztTQUN4RjthQUFNLElBQUksS0FBSyxDQUFDLE1BQU0sSUFBSSxHQUFHLEVBQUU7WUFDNUIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDLE1BQU0sR0FBRyxrQkFBa0IsR0FBRyxJQUFJLENBQUMsV0FBVyxHQUFHLFlBQVksQ0FBQyxDQUFDO1NBQ3BHO0lBQ0wsQ0FBQyxDQUFBO0FBQ0wsQ0FBQyIsImZpbGUiOiJiYWNrZW5kX0pTLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqIENsYXNzIGZvciBidWlsZGluZyBhIGNhcnVzZWwgb24gdGhlIHdlYnBhZ2UgKi9cbmNsYXNzIENhcnVzZWwge1xuXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKCkge1xuICAgIH1cblxuICAgIC8qKlN0YXJ0cyB0aGUgY2FydXNlbCBidWlsZCBhbmQgbG9hZHMgdGhlIEJpZ1Byb2plY3RzLUluZGV4Lmpzb24gZmlsZSAqL1xuICAgIHB1YmxpYyBjYXJ1c2VsKCkge1xuICAgICAgICBsZXQgeGh0dHA6IFhNTEh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIHhodHRwLm9wZW4oXCJHRVRcIiwgXCJSZXNvdXJjZXMvVGV4dHMvQmlnUHJvamVjdHMtSW5kZXguanNvblwiLCB0cnVlKVxuICAgICAgICB4aHR0cC5yZXNwb25zZVR5cGUgPSAnanNvbic7XG4gICAgICAgIHhodHRwLnNlbmQoKTtcbiAgICAgICAgeGh0dHAub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHhodHRwLnJlYWR5U3RhdGUgPT0gNCAmJiB4aHR0cC5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5idWlsZExpc3QoeGh0dHAucmVzcG9uc2UubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB4aHR0cC5yZXNwb25zZS5mb3JFYWNoKChpdGVtOiBpbmRleCwgcG9zOiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWFkTGlzdEl0ZW0oaXRlbSwgcG9zKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSBlbHNlIGlmICh4aHR0cC5zdGF0dXMgIT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coeGh0dHAucmVhZHlTdGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipyZWFkcyBlYWNoIGl0ZW0gb2YgQmlnUHJvamVjdHMtSW5kZXguanNvbiBhbmQgbG9hZHMgdGhlIGluZGV4ZWQgZmlsZXMgKi9cbiAgICBwcml2YXRlIHJlYWRMaXN0SXRlbShpdGVtOiBpbmRleCwgcG9zOiBudW1iZXIpIHtcbiAgICAgICAgbGV0IHJlcXVlc3Q6IFhNTEh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIGxldCBjaGFuZ2VkOiBib29sZWFuID0gdHJ1ZTtcbiAgICAgICAgcmVxdWVzdC5vcGVuKFwiR0VUXCIsIFwiIFJlc291cmNlcy9UZXh0cy9cIiArIGl0ZW0udGl0bGUgKyBcIi5qc29uXCIsIHRydWUpO1xuICAgICAgICByZXF1ZXN0LnJlc3BvbnNlVHlwZSA9ICdqc29uJztcbiAgICAgICAgcmVxdWVzdC5zZW5kKCk7XG4gICAgICAgIHJlcXVlc3Qub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlcXVlc3QucmVhZHlTdGF0ZSA9PSA0ICYmIHJlcXVlc3Quc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRDYXJvdXNlbChyZXF1ZXN0LnJlc3BvbnNlLCBwb3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqYnVpbGRzIHRoZSBvdmVydmlldyBvZiB0aGUgY2FydXNlbCovXG4gICAgcHJpdmF0ZSBidWlsZExpc3QobnVtYmVyOiBudW1iZXIpIHtcbiAgICAgICAgbGV0IHRleHQ6IHN0cmluZztcbiAgICAgICAgbGV0IGFjdGl2ZTogc3RyaW5nO1xuICAgICAgICB0ZXh0ID0gXCJcIjtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1iZXI7IGkrKykge1xuICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICBhY3RpdmUgPSAnIGNsYXNzPVwiYWN0aXZlXCInO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhY3RpdmUgPSAnIGNsYXNzJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRleHQgKz0gXCI8bGkgZGF0YS10YXJnZXQ9XFxcIiNteUNhcm91c2VsXFxcIiBkYXRhLXNsaWRlLXRvPVwiICsgaSArIGFjdGl2ZSArIFwiPjwvbGk+XCI7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY2Fyb3VzZWwtaW5kaWNhdG9yc1wiKS5pdGVtKDApO1xuICAgICAgICBlbGVtZW50Lmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsIHRleHQpO1xuICAgIH1cblxuICAgIC8qKnRha2VzIGVhY2ggcHJvamVjdCBmaWxlIGluZGV4dCBieSBCaWdQcm9qZWN0cy1JbmRleC5qc29uIGFuZCB0dXJucyB0aGVtIGludG8gYSBjYXJkIGZvciB0aGUgY2FydXNlbCBzbGlkZSAqL1xuICAgIHB1YmxpYyBidWlsZENhcm91c2VsKGNhcm91c2VsSXRlbXM6IHByb2plY3RzLCBwb3M6IG51bWJlcikge1xuICAgICAgICBsZXQgc3RyOiBzdHJpbmc7XG4gICAgICAgIGlmIChwb3MgPT09IDApIHtcbiAgICAgICAgICAgIHN0ciA9ICc8ZGl2IGNsYXNzPVwiY2Fyb3VzZWwtaXRlbSBhY3RpdmVcIj4nICsgXCJcXG5cIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0ciA9ICc8ZGl2IGNsYXNzPVwiY2Fyb3VzZWwtaXRlbVwiPicgKyBcIlxcblwiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYXJvdXNlbEl0ZW1zLmNvbG9yID09IG51bGwpIHtcbiAgICAgICAgICAgIGNhcm91c2VsSXRlbXMuY29sb3IgPSBcIiM3NzdcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2Fyb3VzZWxJdGVtcy5waWN0dXJlID09IG51bGwpIHtcbiAgICAgICAgICAgIHN0ciArPSAnPHN2ZyBjbGFzcz1cImJkLXBsYWNlaG9sZGVyLWltZ1wiIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgcHJlc2VydmVBc3BlY3RSYXRpbz1cInhNaWRZTWlkIHNsaWNlXFxcIiBmb2N1c2FibGU9XFxcImZhbHNlXFxcIiByb2xlPVxcXCJpbWdcXFwiPjxyZWN0IHdpZHRoPVxcXCIxMDAlXFxcIiBoZWlnaHQ9XFxcIjEwMCVcXFwiIGZpbGw9XCInICsgY2Fyb3VzZWxJdGVtcy5jb2xvciArICdcIi8+PC9zdmc+JyArIFwiXFxuXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdHIgKz0gJzxpbWcgY2xhc3M9XCJiZC1pbWdcIiB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCIxMDAlXCIgc3JjPVwiJyArIGNhcm91c2VsSXRlbXMucGljdHVyZSArICdcIi8+J1xuICAgICAgICB9XG4gICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz1cImNvbnRhaW5lclwiPicgKyBcIlxcblwiO1xuICAgICAgICBzdHIgKz0gJzxkaXYgY2xhc3M9XCJjYXJvdXNlbC1jYXB0aW9uIHRleHQtbGVmdFwiPicgKyBcIlxcblwiO1xuICAgICAgICBzdHIgKz0gXCI8aDE+XCIgKyBjYXJvdXNlbEl0ZW1zLnRpdGxlICsgXCI8L2gxPlwiICsgXCJcXG5cIjtcbiAgICAgICAgc3RyICs9IFwiPHA+XCIgKyBjYXJvdXNlbEl0ZW1zLmluZm8gKyBcIjwvcD5cIiArIFwiXFxuXCI7XG4gICAgICAgIGlmIChjYXJvdXNlbEl0ZW1zLmJ1dHRvbiA9PSB0cnVlKSB7XG4gICAgICAgICAgICBzdHIgKz0gJzxwIGNsYXNzPVwiYnV0dG9uQ29udGFpbmVyXCI+PGEgY2xhc3M9XCJidG4gYnRuLWxnIGJ0bi1wcmltYXJ5XCIgaHJlZj1cIicgKyBjYXJvdXNlbEl0ZW1zLmxpbmsgKyAnXCIgcm9sZT1cImJ1dHRvblwiPicgKyBjYXJvdXNlbEl0ZW1zLmJ1dHRvbl9waWN0dXJlICsgXCIgXCIgKyBjYXJvdXNlbEl0ZW1zLmJ1dHRvbkxpbmtzVG8gKyAnPC9hPjwvcD4nICsgXCJcXG5cIjtcbiAgICAgICAgfVxuICAgICAgICBzdHIgKz0gXCI8L2Rpdj5cIiArIFwiXFxuXCI7XG4gICAgICAgIHN0ciArPSBcIjwvZGl2PlwiICsgXCJcXG5cIjtcbiAgICAgICAgc3RyICs9IFwiPC9kaXY+XCIgKyBcIlxcblwiO1xuICAgICAgICB0aGlzLmFkZENhcnVzZWxUb0hUTUwoc3RyKVxuICAgIH1cblxuICAgIC8qKkFkZHMgdGhlIGh0bWwgb2YgdGhlIGNhcnVzZWwgdG8gdGhlIHJlc3Qgb2YgdGhlIHNpdGUgKi9cbiAgICBwcml2YXRlIGFkZENhcnVzZWxUb0hUTUwoaHRtbDogc3RyaW5nKSB7XG4gICAgICAgIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYXJvdXNlbC1mcmFtZVwiKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhodG1sKTtcbiAgICAgICAgZWxlbWVudC5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgaHRtbCk7XG4gICAgfVxufVxuXG4vKipDbGFzcyBmb3IgYnVpbGRpbmcgYSBsaXN0IG9mIHNtYWxsZXIgcHJvamVjdHMgb24gdGhlIHdlYnBhZ2UqL1xuY2xhc3MgU21hbGxQcm9qZWN0cyB7XG5cbiAgICBwdWJsaWMgY29uc3RydWN0b3IoKSB7XG4gICAgfVxuXG4gICAgcHVibGljIHNtYWxsUHJvamVjdHMoKSB7XG4gICAgICAgIGxldCBzcFJlcXVlc3Q6IFhNTEh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIHNwUmVxdWVzdC5vcGVuKFwiR0VUXCIsIFwiUmVzb3VyY2VzL1RleHRzL1NtYWxsUHJvamVjdHMtSW5kZXguanNvblwiLCB0cnVlKVxuICAgICAgICBzcFJlcXVlc3QucmVzcG9uc2VUeXBlID0gJ2pzb24nXG4gICAgICAgIHNwUmVxdWVzdC5zZW5kKCk7XG4gICAgICAgIHNwUmVxdWVzdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAoc3BSZXF1ZXN0LnJlYWR5U3RhdGUgPT0gNCAmJiBzcFJlcXVlc3Quc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coc3BSZXF1ZXN0LnJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICBzcFJlcXVlc3QucmVzcG9uc2UuZm9yRWFjaCgoaXRlbTogaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhzcFJlcXVlc3QpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVhZFNtYWxsUHJvamVjdEluZGV4KGl0ZW0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZWFkU21hbGxQcm9qZWN0SW5kZXgoaXRlbTogaW5kZXgpIHtcbiAgICAgICAgbGV0IHJlcXVlc3Q6IFhNTEh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIGxldCBjaGFuZ2VkOiBib29sZWFuID0gdHJ1ZTtcbiAgICAgICAgcmVxdWVzdC5vcGVuKFwiR0VUXCIsIFwiUmVzb3VyY2VzL1RleHRzL1wiICsgaXRlbS50aXRsZSArIFwiLmpzb25cIiwgdHJ1ZSk7XG4gICAgICAgIHJlcXVlc3QucmVzcG9uc2VUeXBlID0gJ2pzb24nO1xuICAgICAgICByZXF1ZXN0LnNlbmQoKTtcbiAgICAgICAgcmVxdWVzdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAocmVxdWVzdC5yZWFkeVN0YXRlID09IDQgJiYgcmVxdWVzdC5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5idWlsZFNtYWxsUHJvamVjdHMocmVxdWVzdC5yZXNwb25zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRTbWFsbFByb2plY3RzKHNtYWxsUHJvamVjdDogcHJvamVjdHMpIHtcbiAgICAgICAgbGV0IHN0cjogc3RyaW5nO1xuICAgICAgICBzdHIgPSAnPGRpdiBjbGFzcz1cImNvbC1sZy00XCI+JyArIFwiXFxuXCI7XG4gICAgICAgIGlmIChzbWFsbFByb2plY3QuY29sb3IgPT0gbnVsbCkge1xuICAgICAgICAgICAgc21hbGxQcm9qZWN0LmNvbG9yID0gXCIjNzc3XCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNtYWxsUHJvamVjdC5waWN0dXJlID09IG51bGwpIHtcbiAgICAgICAgICAgIHN0ciArPSAnPHN2ZyBjbGFzcz1cImJkLXBsYWNlaG9sZGVyLWltZyByb3VuZGVkLWNpcmNsZVwiIHdpZHRoPVwiMTQwXCIgaGVpZ2h0PVwiMTQwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHByZXNlcnZlQXNwZWN0UmF0aW89XCJ4TWlkWU1pZCBzbGljZVwiIGZvY3VzYWJsZT1cImZhbHNlXCIgcm9sZT1cImltZ1wiIGFyaWEtbGFiZWw9XCJQbGFjZWhvbGRlcjogMTQweDE0MFwiPicgKyBcIlxcblwiXG4gICAgICAgICAgICBzdHIgKz0gJzx0aXRsZT5QbGFjZWhvbGRlcjwvdGl0bGU+JyArIFwiXFxuXCJcbiAgICAgICAgICAgIHN0ciArPSAnPHJlY3Qgd2lkdGg9XCIxMDAlXCIgaGVpZ2h0PVwiMTAwJVwiIGZpbGw9XCInICsgc21hbGxQcm9qZWN0LmNvbG9yICsgJ1wiLz4nICsgXCJcXG5cIjtcbiAgICAgICAgICAgIHN0ciArPSAnPHRleHQgY2xhc3M9XCJwbGFjZWhvbGRlclwiIGZvbnQtc2l6ZT1cIjQ1XCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJjZW50cmFsXCIgZmlsbD1cIiNmZmZcIj4gPHRzcGFuIHg9XCI1MCVcIiBkeT1cIjYwJVwiPicgKyBzbWFsbFByb2plY3Quc2hvcnQgKyAnPC90c3Bhbj48L3RleHQ+PC9zdmc+J1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RyICs9ICc8aW1nIGNsYXNzPVwiYmQtaW1nIHJvdW5kZWQtY2lyY2xlXCIgd2lkdGg9XCIxNDBcIiBoZWlnaHQ9XCIxNDBcIiBzcmM9JyArIHNtYWxsUHJvamVjdC5waWN0dXJlICsgJ1wiIGFsdD1cIicgKyBzbWFsbFByb2plY3Quc2hvcnQgKyAnXCIvPidcbiAgICAgICAgfVxuICAgICAgICBzdHIgKz0gXCI8aDI+XCIgKyBzbWFsbFByb2plY3QudGl0bGUgKyBcIjwvaDI+XCIgKyBcIlxcblwiO1xuICAgICAgICBzdHIgKz0gXCI8cD5cIiArIHNtYWxsUHJvamVjdC5pbmZvICsgXCI8L3A+XCIgKyBcIlxcblwiO1xuICAgICAgICBpZiAoc21hbGxQcm9qZWN0LmJ1dHRvbiA9PSB0cnVlICYmIHNtYWxsUHJvamVjdC5idXR0b25fcGljdHVyZSAhPSBudWxsKSB7XG4gICAgICAgICAgICBzdHIgKz0gJzxwPjxhIGNsYXNzPVwiYnRuIGJ0bi1zZWNvbmRhcnlcIiBocmVmPScgKyBzbWFsbFByb2plY3QubGluayArICcgcm9sZT1cImJ1dHRvblwiPicgKyBzbWFsbFByb2plY3QuYnV0dG9uX3BpY3R1cmUgKyBcIiBcIiArIHNtYWxsUHJvamVjdC5idXR0b25MaW5rc1RvICsgJzwvYT48L3A+JyArIFwiXFxuXCI7XG4gICAgICAgIH0gZWxzZSBpZiAoc21hbGxQcm9qZWN0LmJ1dHRvbiA9PSB0cnVlKSB7XG4gICAgICAgICAgICBzdHIgKz0gJzxwPjxhIGNsYXNzPVwiYnRuIGJ0bi1zZWNvbmRhcnlcIiBocmVmPScgKyBzbWFsbFByb2plY3QubGluayArICcgcm9sZT1cImJ1dHRvblwiPicgKyBzbWFsbFByb2plY3QuYnV0dG9uTGlua3NUbyArICc8L2E+PC9wPicgKyBcIlxcblwiO1xuICAgICAgICB9XG4gICAgICAgIHN0ciArPSBcIjwvZGl2PlwiICsgXCJcXG5cIjtcbiAgICAgICAgdGhpcy5hZGRTbWFsbFByb2plY3RUb0hUTUwoc3RyKVxuICAgIH1cblxuXG4gICAgcHJpdmF0ZSBhZGRTbWFsbFByb2plY3RUb0hUTUwoaHRtbDogc3RyaW5nKSB7XG4gICAgICAgIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzcFwiKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhodG1sKTtcbiAgICAgICAgZWxlbWVudC5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgaHRtbCk7XG4gICAgfVxufVxuXG4vKiBJREVBIGNoYW5nZSBzY3JpcHQgdG8gbG9hZC91bmxvYWQgY29udGVudCB1bmRlciB0aGUgaGVhZGVyIHNvIGkgY2FuIHVzZSBhIHNpbmdsZSB1cmw/XG4gKiBcbiAqL1xuXG5cbi8qTUFJTiovXG5sZXQgY2FydXNlbDogQ2FydXNlbCA9IG5ldyBDYXJ1c2VsO1xubGV0IHNtYWxsUHJvamVjdHM6IFNtYWxsUHJvamVjdHMgPSBuZXcgU21hbGxQcm9qZWN0cztcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgZnVuY3Rpb24gKCkge1xufSwgdHJ1ZSk7XG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XG4gICAgc3RhcnQodHJ1ZSlcbn0pO1xuXG5mdW5jdGlvbiBzdGFydChmaXJzdFJ1bjogYm9vbGVhbikge1xuICAgIGlmIChmaXJzdFJ1bikge1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIlByb2plY3RzXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjaGFuZ2VBY3Rpdk5hdkl0ZW0pO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIlNraWxsc1wiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2hhbmdlQWN0aXZOYXZJdGVtKTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJDb250YWN0XCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjaGFuZ2VBY3Rpdk5hdkl0ZW0pO1xuICAgIH1cblxuICAgIGxldCBhY3Rpdk5hdkl0ZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwibmF2LWl0ZW0gYWN0aXZlXCIpWzBdLmNoaWxkcmVuWzBdLnRleHRDb250ZW50XG4gICAgaWYgKGFjdGl2TmF2SXRlbSA9PSBcIlByb2plY3RzXCIpIHtcbiAgICAgICAgbG9hZFN1YlNpdGUoYWN0aXZOYXZJdGVtKTtcbiAgICAgICAgY2FydXNlbC5jYXJ1c2VsKCk7XG4gICAgICAgIHNtYWxsUHJvamVjdHMuc21hbGxQcm9qZWN0cygpO1xuICAgIH0gZWxzZSBpZiAoYWN0aXZOYXZJdGVtID09IFwiU2tpbGxzXCIpIHtcbiAgICAgICAgbG9hZFN1YlNpdGUoYWN0aXZOYXZJdGVtKVxuXG4gICAgfSBlbHNlIGlmIChhY3Rpdk5hdkl0ZW0gPT0gXCJDb250YWN0XCIpIHtcbiAgICAgICAgbG9hZFN1YlNpdGUoYWN0aXZOYXZJdGVtKVxuICAgIH1cbn1cblxuLyoqIENoYW5nZXMgdGhlIGFjdGl2ZSBOYXZJdGVtIHRvIHRoZSBjbGlja2VkIG9uZSovXG5mdW5jdGlvbiBjaGFuZ2VBY3Rpdk5hdkl0ZW0oZTogRXZlbnQpIHtcbiAgICAvL0B0cy1pZ25vcmVcbiAgICBsZXQgbmF2SXRlbTogSFRNTEVsZW1lbnQgPSBlLmN1cnJlbnRUYXJnZXQ7XG4gICAgbGV0IGFjdGl2TmF2SXRlbTogSFRNTENvbGxlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwibmF2LWl0ZW0gYWN0aXZlXCIpXG4gICAgaWYgKGFjdGl2TmF2SXRlbS5sZW5ndGggPD0gMSkge1xuICAgICAgICBhY3Rpdk5hdkl0ZW1bMF0uY2hpbGRyZW5bMF0uc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJuYXYtbGlua1wiKTtcbiAgICAgICAgYWN0aXZOYXZJdGVtWzBdLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibmF2LWl0ZW1cIik7XG4gICAgfVxuICAgIG5hdkl0ZW0uc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJuYXYtbGluayBkaXNhYmxlZFwiKTtcbiAgICBuYXZJdGVtLnBhcmVudEVsZW1lbnQuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJuYXYtaXRlbSBhY3RpdmVcIik7XG4gICAgc3RhcnQoZmFsc2UpO1xufVxuXG5mdW5jdGlvbiBsb2FkU3ViU2l0ZShuYW1lOiBTdHJpbmcpIHtcbiAgICBsZXQgeGh0dHA6IFhNTEh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgeGh0dHAub3BlbihcIkdFVFwiLCBcIlJlc291cmNlcy9TdWJzaXRlcy9cIiArIG5hbWUudG9Mb3dlckNhc2UoKSArIFwiLmh0bWxcIiwgdHJ1ZSlcbiAgICB4aHR0cC5yZXNwb25zZVR5cGUgPSAndGV4dCc7XG4gICAgeGh0dHAuc2VuZCgpO1xuICAgIHhodHRwLm9ucmVhZHlzdGF0ZWNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgaWYgKHhodHRwLnJlYWR5U3RhdGUgPT0gNCAmJiB4aHR0cC5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgICAgICBsZXQgb2xkc3Vic2l0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJjb250ZW50XCIpLml0ZW0oMCk7XG4gICAgICAgICAgICBpZiAob2xkc3Vic2l0ZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgb2xkc3Vic2l0ZS5yZW1vdmUoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGlja3lIZWFkXCIpLmluc2VydEFkamFjZW50SFRNTChcImFmdGVyZW5kXCIsIHhodHRwLnJlc3BvbnNlKTtcbiAgICAgICAgfSBlbHNlIGlmICh4aHR0cC5zdGF0dXMgIT0gMjAwKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkhUVFAgRXJyb3IgXCIgKyB4aHR0cC5zdGF0dXMgKyBcIlxcbndoaWxlIGxvYWRpbmcgXCIgKyBuYW1lLnRvTG93ZXJDYXNlICsgXCIuaHRtbCBmaWxlXCIpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vKiogT2JqZWN0dHlwZXMgZnJvbSB0aGUgSlNPTlMgKi9cblxuaW50ZXJmYWNlIHByb2plY3RzIHtcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIHNob3J0OiBzdHJpbmc7XG4gICAgaW5mbzogc3RyaW5nO1xuICAgIHBpY3R1cmU6IHN0cmluZztcbiAgICBjb2xvcjogc3RyaW5nO1xuICAgIGJ1dHRvbjogYm9vbGVhbjtcbiAgICBidXR0b25fcGljdHVyZTogc3RyaW5nO1xuICAgIGJ1dHRvbkxpbmtzVG86IHN0cmluZztcbiAgICBsaW5rOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBpbmRleCB7XG4gICAgdGl0bGU6IHN0cmluZztcbn0iXX0=
